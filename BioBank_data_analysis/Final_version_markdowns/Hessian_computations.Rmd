---
title: "Hessian computations for significant features"
author: "Nitay Alon"
date: "8/15/2019"
output: html_document
---

In this report we compute the hessian matrix for MLE computed by the EM algorithm in order to compute CI for each parameter.
```{r loadin libraries, include=FALSE}
load("~/Human_brain_research/BioBank_data_analysis/Final_data_for_analysis/biobank_feature_residual_analysis.RData")
load("~/Human_brain_research/BioBank_data_analysis/Final_data_for_analysis/biobank_feature_standard_analysis.RData")
load("~/Human_brain_research/BioBank_data_analysis/Final_data_for_analysis/BioBank_residual_data.RData")
load("~/Human_brain_research/BioBank_data_analysis/Final_data_for_analysis/BioBank_standardized_data.RData")
```


```{r computing the hessian for a given feature, include=FALSE}
mle_parameters_list <- biobank_feature_residual_analysis$`Mean FA in middle cerebellar peduncle on FA skeleton`$hypothesis_results$pure_type_vs_mixed_gender_em_results$alternative_hypothesis$m_parameters

observations <- biobank_residuals_data$`Mean FA in middle cerebellar peduncle on FA skeleton`

h <- computeHessianForMixtureModel(observations, mle_parameters_list)
fisher <- solve(-h)
sqrt(diag(fisher))
```

