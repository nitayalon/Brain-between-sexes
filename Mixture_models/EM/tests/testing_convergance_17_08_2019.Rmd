---
title: "testing convergence 17/08/2019"
author: "Nitay Alon"
date: "8/17/2019"
output: html_document
---

It seems that there's a problem with the convergence of the EM to MLE (as reflected by the gradient). The following modifications were conducted:

1. Removed any protection against NA - must validate why they appear
2. Pooled variance instead of separate

```{r debugging the new method, include=FALSE}
suspect_feature <- sample(list.of.names,1)

suspect_feature_analysis <-fullBrainFeatureAnalysis(suspect_feature,list.of.names,user_data)

suspect_feature_analysis$hypothesis_results$pure_type_vs_mixed_gender_em_results$alternative_hypothesis$m_samples

mle <- suspect_feature_analysis$hypothesis_results$pure_type_vs_mixed_gender_em_results$alternative_hypothesis$m_parameters

grd <- computeGradientForMixtureModel(suspect_feature_analysis$feature_residuals, mle)

hessian <- computeHessianForMixtureModel(suspect_feature_analysis$feature_residuals, mle)
eigen(-hessian)
diag(solve(-hessian))
# biobank_full_analysis_list_new <- 
# pblapply(list.of.names,function(x){
  # fullBrainFeatureAnalysis(x,list.of.names,user_data)})
```

